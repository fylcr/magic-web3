# .github/workflows/publish-docs-to-readme.yml
name: Publish Docs to ReadMe

on:
  push:
    # ä»…å½“ docs åˆ†æ”¯æœ‰æ›´æ–°æ—¶è§¦å‘
    branches:
      - docs

jobs:
  publish-readme:
    runs-on: ubuntu-latest

    steps:
      # 1. æ‹‰å–ä»£ç 
      - name: Checkout repo
        uses: actions/checkout@v4
        with:
          # ç¡®ä¿è·å–æ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…å«å­æ¨¡å—ï¼ˆå¦‚æœ‰ï¼‰
          fetch-depth: 0

      # 2. å®‰è£… Node.js ç¯å¢ƒï¼ˆrdme CLI éœ€è¦ï¼‰
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 20

      # 3. å…¨å±€å®‰è£… rdme CLI
      - name: Install rdme CLI
        run: npm install -g @readme/rdme

      # 4. ä¸Šä¼  docs ç›®å½•ä¸‹çš„ MDX/Markdown æ–‡æ¡£
      - name: Publish MDX docs to ReadMe
        env:
          # åœ¨ä»“åº“ Settings â†’ Secrets ä¸­æ·»åŠ ä½ çš„ README_API_KEY
          README_API_KEY: ${{ secrets.README_API_KEY }}
        run: |
          # rdme docs ä¼šæ‰«ææŒ‡å®šç›®å½•ä¸‹çš„ .md/.mdx æ–‡ä»¶å¹¶åŒæ­¥åˆ° ReadMe.com
          rdme docs ./docs \
            --key "$README_API_KEY" \
            # ï¼ˆå¯é€‰ï¼‰æŒ‡å®šé¡¹ç›® IDï¼Œå¦‚æœä½ æœ‰å¤šä¸ªé¡¹ç›®éœ€è¦ä¸Šä¼ åˆ°æŒ‡å®šé¡¹ç›®ï¼š
            # --id your-project-id 

      # ã€å¯é€‰ã€‘5. åœ¨å‘å¸ƒå®Œæˆååšç‚¹å°æç¤º
      - name: Done
        run: echo "ğŸ“š Docs have been published to ReadMe.com ğŸ‰"
